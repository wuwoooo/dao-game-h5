import{d as I,s as D,r as g,i as p,o as j,b as G,c as a,e as l,f as e,g as u,j as m,k as y,l as f,m as L,t as n,F as N,p as V,x as B,_ as R}from"./index-sn2Iz1lD.js";import{d as S,r as $,e as z}from"./game-CibO7eY-.js";const F={class:"w-full max-w-full overflow-x-hidden"},A={class:"py-4 px-2 sm:px-4 md:px-6 lg:px-8 sticky top-0 bg-white/90 backdrop-blur-md z-50 shadow-sm w-full"},E={class:"max-w-7xl mx-auto flex items-center justify-between"},H={style:{display:"none"}},M={key:0,class:"flex items-center"},T={class:"pt-4"},U={key:0,class:"text-center py-8"},q={key:1,class:"text-center py-8"},J={class:"text-red-600"},K={key:2,class:"px-2 sm:px-4 md:px-6 lg:px-8 max-w-7xl mx-auto"},O={class:"mb-4"},P={class:"bg-white rounded-xl shadow-lg overflow-hidden"},Q={class:"w-full h-64 md:h-80 lg:h-96 relative overflow-hidden"},W=["src","alt"],X={class:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent p-6"},Y={class:"flex items-center justify-between"},Z={class:"text-3xl font-bold text-white"},ee={class:"px-4 py-2 bg-indigo-500 text-white rounded-full text-sm font-medium"},te={class:"p-6 md:p-8"},se={class:"text-gray-700 mb-6 leading-relaxed"},oe={class:"flex flex-wrap gap-2 mb-6"},le={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8"},ae={class:"bg-gray-50 p-4 rounded-lg text-center"},ne={class:"text-2xl font-semibold text-indigo-600"},ie={class:"bg-gray-50 p-4 rounded-lg text-center"},de={class:"text-lg font-semibold text-gray-700"},re={class:"bg-gray-50 p-4 rounded-lg text-center"},ce={class:"text-lg font-semibold text-gray-700"},me={class:"flex justify-center md:justify-start"},ue={key:1,class:"bg-gray-600 text-white px-8 py-3 rounded-lg cursor-not-allowed flex items-center",disabled:""},xe=I({__name:"GameDetail",setup(ge){const h=D(),s=g(null),x=g(!0),c=g(""),v=p("openLoginReminder"),w=p("isLoggedIn"),_=p("logout");function k(i){return i?new Date(i).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"}):"未知"}async function b(){var t,d;const i=h.params.id;x.value=!0,c.value="";try{const o=await S(i);o.data?(s.value=o.data,s.value&&(await $({uid:localStorage.getItem("uid")||"anonymous",gameappId:parseInt(s.value.id)}),console.log(`记录游戏浏览: ${s.value.id}`))):c.value=o.data.msg||"获取游戏详情失败"}catch(o){c.value=((d=(t=o==null?void 0:o.response)==null?void 0:t.data)==null?void 0:d.msg)||"获取游戏详情失败"}finally{x.value=!1}}async function C(){if(s.value)try{await z({uid:localStorage.getItem("uid")||"anonymous",gameappId:parseInt(s.value.id)}),console.log(`记录游戏点击: ${s.value.id}`)}catch(i){console.error("记录游戏点击失败:",i)}}return j(b),(i,t)=>{var o;const d=G("router-link");return l(),a("div",F,[e("header",A,[e("div",E,[t[5]||(t[5]=e("div",{class:"text-xl sm:text-2xl font-bold text-indigo-600"},[e("i",{class:"fas fa-rocket mr-1"}),u("DaoGame ")],-1)),e("nav",H,[m(w)()?(l(),a("div",M,[y(d,{to:"/my-games",class:"text-slate-600 hover:text-indigo-600 flex items-center mr-4"},{default:f(()=>t[2]||(t[2]=[e("i",{class:"fas fa-gamepad text-xl mr-1"},null,-1),e("span",{class:"text-sm hidden sm:inline"},"我的游戏",-1)])),_:1}),e("button",{onClick:t[0]||(t[0]=(...r)=>m(_)&&m(_)(...r)),class:"text-slate-600 hover:text-indigo-600 flex items-center"},t[3]||(t[3]=[e("i",{class:"fas fa-sign-out-alt text-xl mr-1"},null,-1),e("span",{class:"text-sm hidden sm:inline"},"退出",-1)]))])):(l(),a("button",{key:1,onClick:t[1]||(t[1]=(...r)=>m(v)&&m(v)(...r)),class:"text-slate-600 hover:text-indigo-600 flex items-center"},t[4]||(t[4]=[e("i",{class:"fas fa-user-circle text-xl mr-1"},null,-1),e("span",{class:"text-sm hidden sm:inline"},"登录",-1)])))])])]),e("main",T,[x.value?(l(),a("div",U,t[6]||(t[6]=[e("div",{class:"inline-block animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-indigo-500 mb-6"},null,-1),e("p",{class:"text-gray-600"},"加载中...",-1)]))):c.value?(l(),a("div",q,[t[7]||(t[7]=e("i",{class:"fas fa-exclamation-triangle text-5xl text-red-500 mb-4"},null,-1)),e("p",J,n(c.value),1),e("button",{onClick:b,class:"mt-4 bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700"}," 重试 ")])):s.value?(l(),a("div",K,[e("div",O,[y(d,{to:"/",class:"text-indigo-600 flex items-center hover:text-indigo-800 transition-colors"},{default:f(()=>t[8]||(t[8]=[e("i",{class:"fas fa-arrow-left mr-2"},null,-1),u(" 返回首页 ")])),_:1})]),e("div",P,[e("div",Q,[e("img",{src:s.value.icon||s.value.coverImage,alt:s.value.name,class:"w-full h-full object-cover"},null,8,W),e("div",X,[e("div",Y,[e("h1",Z,n(s.value.name),1),e("span",ee,n(s.value.type==="Game"?"游戏":"应用"),1)])])]),e("div",te,[e("p",se,n(s.value.description),1),e("div",oe,[(l(!0),a(N,null,V((o=s.value.tags)==null?void 0:o.split(","),r=>(l(),a("span",{key:r,class:"px-3 py-1 bg-indigo-100 text-indigo-600 text-sm rounded-full"},n(r),1))),128))]),e("div",le,[e("div",ae,[t[9]||(t[9]=e("h3",{class:"text-sm text-gray-500 mb-1"},"点击量",-1)),e("p",ne,n(s.value.clickCount||0),1)]),e("div",ie,[t[10]||(t[10]=e("h3",{class:"text-sm text-gray-500 mb-1"},"上架时间",-1)),e("p",de,n(k(s.value.createdAt)),1)]),e("div",re,[t[11]||(t[11]=e("h3",{class:"text-sm text-gray-500 mb-1"},"所有者",-1)),e("p",ce,n(s.value.ownerName),1)])]),e("div",me,[s.value.embedUrl?(l(),B(d,{key:0,to:`/game/${s.value.id}/play`,class:"bg-indigo-600 text-white px-8 py-3 rounded-lg hover:bg-indigo-700 button-hover-scale flex items-center",onClick:C},{default:f(()=>t[12]||(t[12]=[e("i",{class:"fas fa-play-circle mr-2"},null,-1),u(" 开始体验 ")])),_:1},8,["to"])):(l(),a("button",ue,t[13]||(t[13]=[e("i",{class:"fas fa-clock mr-2"},null,-1),u(" 暂未开放 ")])))])])])])):L("",!0)])])}}}),ve=R(xe,[["__scopeId","data-v-3d08955d"]]);export{ve as default};

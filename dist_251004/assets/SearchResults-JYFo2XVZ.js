import{d as R,s as S,u as P,r as f,C as N,o as M,y as $,b as j,c as n,e as i,f as t,k as p,l as h,g as u,w as z,v as D,h as G,t as w,D as B,m as F,q as _,F as I,p as L,_ as T}from"./index-sn2Iz1lD.js";import{s as E}from"./game-CibO7eY-.js";import{G as Q}from"./GameList-Ge2SVFm8.js";const U={class:"w-full max-w-full overflow-x-hidden"},A={class:"py-4 px-2 sm:px-4 md:px-6 lg:px-8 sticky top-0 bg-white/90 backdrop-blur-md z-50 shadow-sm w-full"},H={class:"max-w-7xl mx-auto flex items-center justify-between"},J={class:"flex-grow max-w-xl mx-2 sm:mx-4"},K={class:"relative"},O=["placeholder"],W={style:{display:"none"}},X={class:"pt-4 px-2 sm:px-4 md:px-6 lg:px-8 max-w-7xl mx-auto"},Y={class:"flex items-center justify-between mb-6"},Z={class:"text-lg sm:text-xl md:text-2xl font-bold text-slate-800"},ee={class:"text-indigo-600"},te={key:0,class:"text-center py-16 bg-white rounded-xl shadow-md"},se={key:1,class:"text-center py-12 bg-white rounded-xl shadow-md"},ae={class:"text-red-600 text-lg mb-4"},le={key:2,class:"text-center py-16 bg-white rounded-xl shadow-md"},oe={key:3},re={class:"mb-6 bg-gray-50 rounded-lg p-4 text-sm text-gray-600 flex items-center shadow-sm"},ne={class:"font-semibold mx-1 text-indigo-600"},ie={key:0,class:"flex justify-center mt-8 mb-8"},de={class:"flex items-center space-x-2 bg-white px-4 py-3 rounded-xl shadow-sm"},ue=["disabled"],ve=["onClick"],xe={key:1,class:"px-4 py-2 text-gray-500"},ce=["disabled"],C=12,me=R({__name:"SearchResults",setup(fe){const g=S(),q=P(),o=f(""),y=f(!0),v=f(""),x=f([]),c=f(0),l=f(1),d=N(()=>Math.ceil(c.value/C)),V=N(()=>{const a=[];if(d.value<=5)for(let s=1;s<=d.value;s++)a.push(s);else{a.push(1);let s=Math.max(2,l.value-1),r=Math.min(d.value-1,l.value+1);s>2&&a.push("...");for(let b=s;b<=r;b++)a.push(b);r<d.value-1&&a.push("..."),a.push(d.value)}return a});M(()=>{o.value=g.query.keyword||"",l.value=Number(g.query.page)||1,o.value&&m()}),$(()=>[g.query.keyword,g.query.page],([a,e])=>{(a&&a!==o.value||e&&Number(e)!==l.value)&&(o.value=a||o.value,l.value=Number(e)||1,m())});function k(a){const e=typeof a=="string"?parseInt(a):a;e<1||e>d.value||q.push({name:"search-results",query:{keyword:o.value,page:e.toString()}})}async function m(){var a,e;if(o.value!==g.query.keyword){q.push({name:"search-results",query:{keyword:o.value,page:1}});return}if(o.value.trim()){y.value=!0,v.value="",x.value=[];try{const s=await E({keyword:o.value,current:l.value,size:C});s.data&&s.data.records?(x.value=s.data.records,c.value=s.data.total||0):s.data&&s.data.data&&s.data.data.records?(x.value=s.data.data.records,c.value=s.data.data.total||0):(x.value=[],c.value=0,v.value="未找到相关游戏或应用")}catch(s){console.error("搜索出错:",s),v.value=((e=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:e.msg)||"搜索失败，请稍后重试"}finally{y.value=!1}}}return(a,e)=>{const s=j("router-link");return i(),n("div",U,[t("header",A,[t("div",H,[p(s,{to:"/",class:"text-xl sm:text-2xl font-bold text-indigo-600"},{default:h(()=>e[3]||(e[3]=[t("i",{class:"fas fa-rocket mr-1"},null,-1),u("DaoGame ")])),_:1}),t("div",J,[t("div",K,[z(t("input",{type:"search","onUpdate:modelValue":e[0]||(e[0]=r=>o.value=r),onKeyup:G(m,["enter"]),placeholder:"搜索: "+a.$route.query.keyword,style:{color:"wheat"},class:"w-full py-2.5 px-4 pr-10 text-sm text-slate-700 rounded-full border border-slate-300 focus:ring-2 focus:ring-indigo-500 focus:outline-none focus:border-indigo-500 transition-all"},null,40,O),[[D,o.value]]),t("button",{onClick:m,class:"absolute right-0 top-0 bottom-0 px-3 text-slate-500 hover:text-indigo-600"},e[4]||(e[4]=[t("i",{class:"fas fa-search text-sm"},null,-1)]))])]),t("nav",W,[p(s,{to:"/my-games",class:"text-slate-600 hover:text-indigo-600 flex items-center"},{default:h(()=>e[5]||(e[5]=[t("i",{class:"fas fa-user-circle text-xl mr-1"},null,-1),t("span",{class:"text-sm hidden sm:inline"},"我的",-1)])),_:1})])])]),t("main",X,[t("div",Y,[t("h1",Z,[e[6]||(e[6]=t("i",{class:"fas fa-search mr-2 text-indigo-500"},null,-1)),e[7]||(e[7]=u("搜索结果: ")),t("span",ee,w(a.$route.query.keyword),1)]),p(s,{to:"/",class:"text-indigo-600 hover:text-indigo-800 flex items-center button-hover-scale"},{default:h(()=>e[8]||(e[8]=[t("i",{class:"fas fa-arrow-left mr-1"},null,-1),u(" 返回首页 ")])),_:1})]),y.value?(i(),n("div",te,e[9]||(e[9]=[B('<div class="inline-block animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-indigo-500 mb-6" data-v-51096260></div><p class="text-gray-600 text-lg" data-v-51096260>搜索中...</p><div class="flex justify-center mt-6 space-x-1" data-v-51096260><div class="h-2 w-2 bg-indigo-400 rounded-full animate-bounce" style="animation-delay:0s;" data-v-51096260></div><div class="h-2 w-2 bg-indigo-500 rounded-full animate-bounce" style="animation-delay:0.2s;" data-v-51096260></div><div class="h-2 w-2 bg-indigo-600 rounded-full animate-bounce" style="animation-delay:0.4s;" data-v-51096260></div></div>',3)]))):v.value?(i(),n("div",se,[e[11]||(e[11]=t("i",{class:"fas fa-exclamation-triangle text-5xl text-red-500 mb-4"},null,-1)),t("p",ae,w(v.value),1),t("button",{onClick:m,class:"mt-4 bg-indigo-600 text-white px-6 py-3 rounded-lg hover:bg-indigo-700 button-hover-scale transition-all duration-300"},e[10]||(e[10]=[t("i",{class:"fas fa-sync-alt mr-2"},null,-1),u("重试 ")]))])):x.value.length===0?(i(),n("div",le,[e[13]||(e[13]=t("i",{class:"fas fa-search text-6xl text-gray-400 mb-6"},null,-1)),e[14]||(e[14]=t("p",{class:"text-gray-600 text-xl mb-6"},"没有找到相关游戏或应用",-1)),p(s,{to:"/",class:"inline-block bg-indigo-600 text-white px-8 py-3 rounded-lg hover:bg-indigo-700 button-hover-scale text-lg transition-all duration-300"},{default:h(()=>e[12]||(e[12]=[t("i",{class:"fas fa-th-large mr-2"},null,-1),u("浏览全部游戏 ")])),_:1})])):(i(),n("div",oe,[t("div",re,[e[15]||(e[15]=t("i",{class:"fas fa-info-circle text-indigo-500 mr-2"},null,-1)),e[16]||(e[16]=u(" 找到 ")),t("span",ne,w(c.value),1),e[17]||(e[17]=u(" 个结果 "))]),p(Q,{games:x.value,loading:y.value,error:v.value,onRefresh:m},null,8,["games","loading","error"]),c.value>C?(i(),n("div",ie,[t("div",de,[t("button",{onClick:e[1]||(e[1]=r=>k(l.value-1)),disabled:l.value<=1,class:_(["px-4 py-2 rounded-lg border hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",l.value<=1?"text-gray-400":"text-indigo-600"])},e[18]||(e[18]=[t("i",{class:"fas fa-chevron-left"},null,-1)]),10,ue),(i(!0),n(I,null,L(V.value,r=>(i(),n("div",{key:r,class:"flex"},[r!=="..."?(i(),n("button",{key:0,onClick:b=>k(r),class:_(["px-4 py-2 rounded-lg transition-all duration-200",l.value===r?"bg-indigo-600 text-white button-hover-scale":"border hover:bg-gray-100 text-slate-700"])},w(r),11,ve)):(i(),n("span",xe,"..."))]))),128)),t("button",{onClick:e[2]||(e[2]=r=>k(l.value+1)),disabled:l.value>=d.value,class:_(["px-4 py-2 rounded-lg border hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",l.value>=d.value?"text-gray-400":"text-indigo-600"])},e[19]||(e[19]=[t("i",{class:"fas fa-chevron-right"},null,-1)]),10,ce)])])):F("",!0)]))])])}}}),be=T(me,[["__scopeId","data-v-51096260"]]);export{be as default};

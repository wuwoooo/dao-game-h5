import{H as a,Q as s,P as o}from"./index-sn2Iz1lD.js";const n="https://t-dao.aisky.io/api",l="https://t-api.aisky.io/polarisex";async function m(t){try{return await a.post(`${n}/h5/auth/temp-token?deviceId=${t}`,"",{headers:{accept:"*/*"}})}catch(e){throw console.error("获取临时token失败:",e),e}}function p(t){a.defaults.headers.common.Authorization=`Bearer ${t}`}function y(){const t=localStorage.getItem("temp_token"),e=localStorage.getItem("temp_token_expiry");return!t||!e?!1:new Date().getTime()>parseInt(e)?(g(),!1):(p(t),!0)}function g(){localStorage.removeItem("temp_token"),localStorage.removeItem("temp_token_expiry"),delete a.defaults.headers.common.Authorization}function f(t){const e=new Date().getTime()+36e5;localStorage.setItem("temp_token",t),localStorage.setItem("temp_token_expiry",e.toString()),p(t)}async function c(t){if(!y()){const e="web_"+Math.random().toString(36).substring(2,15);try{const r=await m(e);if(r.data&&r.data.code===0)f(r.data.data);else throw new Error("获取临时token响应异常")}catch{throw new Error("无法获取临时授权，请稍后再试")}}return t()}async function $(){return c(()=>a.get(`${n}/v1/lottery/active`,{params:{locale:o()}}))}async function d(t,e){return c(()=>{const r=`${n}/v1/lottery/${t}`,i={locale:o()};return e&&(i.uid=e),a.get(r,{params:i})})}async function k(t,e,r,i){return c(()=>a.post(`${n}/v1/lottery/participate`,{lotteryId:t,uid:e,uuid:r,token:i},{params:{locale:s(o())}}))}async function I(t){return c(()=>a.get(`${n}/v1/lottery/user/${t}/wins`,{params:{locale:s(o())}}))}async function T(t,e){return c(()=>{const r={...e,locale:s(o())};return a.get(`${n}/v1/lottery/user/${t}/participations`,{params:r})})}async function w(t,e){return c(()=>a.put(`${n}/v1/lottery/winner/${t}/claim`,null,{params:{contactInfo:e,locale:s(o())}}))}async function A(t,e,r){const i={lotteryId:t,inviterUid:e,inviteUrl:r};return console.log("API请求数据:",i),console.log("请求URL:",`${n}/v1/lottery/help/invite`),c(()=>a.post(`${n}/v1/lottery/help/invite`,i,{params:{locale:s(o())}}))}async function S(t,e){return c(()=>a.get(`${n}/v1/lottery/help/${t}/my-invite`,{params:{inviterUid:e,locale:s(o())}}))}async function _(t){return c(()=>a.get(`${n}/v1/lottery/help/invite/${t}`,{params:{locale:s(o())}}))}async function L(t,e){return c(()=>a.post(`${n}/v1/lottery/help/assist`,{inviteCode:t,helperUid:e},{params:{locale:s(o())}}))}async function P(t,e){return c(()=>a.get(`${n}/v1/lottery/help/${t}/my-stats`,{params:{uid:e,locale:s(o())}}))}async function H(t,e){return c(()=>a.get(`${n}/v1/lottery/help/${t}/my-records`,{params:{uid:e,locale:s(o())}}))}async function R(t,e=10){return c(()=>a.get(`${n}/v1/lottery/help/${t}/ranking`,{params:{limit:e,locale:s(o())}}))}async function x(t){return a.get(`${n}/v1/lottery/help/${t}/config`,{params:{locale:s(o())}})}async function U(t,e,r){return a.get(`${l}/open/redpacket/my/info`,{params:{uuid:t,token:e,uid:r}})}async function C(t,e,r,i){return a.get(`${l}/open/activity/details`,{params:{uuid:t,token:e,uid:r,activityId:i,locale:s(o())}})}async function D(t,e,r,i,u){return a.post(`${l}/open/activity/chatroom/join`,null,{params:{uuid:t,token:e,uid:r,userinfo:u,roomId:i,locale:s(o())}})}function h(){return new URLSearchParams(window.location.search).get("isApp")==="1"?(sessionStorage.setItem("isApp","1"),!0):sessionStorage.getItem("isApp")==="1"}function b(){return h()?"pt-14":""}export{$ as a,P as b,g as c,R as d,H as e,x as f,b as g,S as h,A as i,L as j,U as k,d as l,C as m,D as n,y as o,k as p,m as q,I as r,f as s,T as t,w as u,_ as v};
